<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <title>Bresolin Im√≥veis | Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/static/img/icons/favicon_bresolin_rounded.png" type="image/png">
  <link rel="stylesheet" href="/static/css/dashboard.css">
  <link rel="stylesheet" href="/static/css/components/card_imovel.css">
</head>

<body>

  <!-- ===========================
       M√ìDULO: SIDEBAR
       =========================== -->
  <aside class="sidebar">
    <div class="brand">Dashboard</div>
    <nav class="menu">
      <button class="menu-item active" data-target="view-imoveis">Im√≥veis</button>
      <button class="menu-item" data-target="view-cadastro">Cadastro</button>
      <button class="menu-item" data-target="view-info">Info</button>
      <button class="menu-item" data-target="view-corretores">Corretores</button>
      <button class="menu-item" data-target="view-slides">Slides</button>
    </nav>
  </aside>

  <!-- ===========================
       M√ìDULO: CONTE√öDO PRINCIPAL
       =========================== -->
  <main class="content">

    <!-- ===========================
         M√ìDULO: VIEW IM√ìVEIS
         =========================== -->
    <section id="view-imoveis" class="view active">
      <header class="view-header">
        <h1>Im√≥veis</h1>
        <div class="actions">
          <input id="busca-imoveis" type="search" placeholder="Buscar por t√≠tulo ou ID‚Ä¶">
          <button id="btn-atualizar">Atualizar</button>
        </div>
      </header>

      <div class="grid-blocos">

        <!-- Bloco: Todos os Itens -->
        <div class="bloco">
          <div class="bloco-head">
            <h2>Todos</h2>
            <small class="bloco-subtitle">Clique no card para editar</small>

            <!-- Filtros de Dashboard -->
            <div class="filtros-dashboard">
              <select id="filtro-tipo" class="filtro-select">
                <option value="todos">Todos</option>
                <option value="imoveis">Im√≥veis</option>
                <option value="empreendimentos">Empreendimentos</option>
              </select>

              <label class="switch filtro-switch">
                <input type="checkbox" id="filtro-ativo" checked>
                <span class="slider"></span>
                <small>Apenas Ativos</small>
              </label>
            </div>
          </div>
          <div id="lista-admin" class="cards">
            <!-- Os cards s√£o renderizados via JS -->
          </div>
        </div>



      </div>
    </section>

    <!-- ===========================
         M√ìDULO: VIEW CADASTRO
         =========================== -->
    <section id="view-cadastro" class="view">
      <header class="view-header">
        <h1>Cadastro</h1>
        <div class="actions">
          <button type="button" id="btn-limpar-form" class="secondary">Limpar Formul√°rio</button>
        </div>
      </header>

      <!-- Abas de Cadastro -->
      <div class="cadastro-tabs">
        <button class="tab-button active" data-tab="tab-imoveis">Im√≥veis</button>
        <button class="tab-button" data-tab="tab-empreendimentos">Empreendimentos</button>
      </div>

      <!-- ===========================
           M√ìDULO: FORMUL√ÅRIO IM√ìVEIS
           =========================== -->
      <div id="tab-imoveis" class="tab-content active">
        <form id="form-imovel" class="form-grid">
          <input type="text" name="titulo" placeholder="T√≠tulo do im√≥vel">
          <textarea name="descricao" placeholder="Descri√ß√£o"></textarea>

          <!-- Grupo: Imagem Principal -->
          <div class="grupo-imagem-principal">
            <div class="coluna-imagem">
              <label>Imagem principal:</label>
              <input type="file" id="file-imagem" accept="image/*">
              <input type="text" name="imagem" id="input-imagem" placeholder="Ou informe uma URL da imagem">
            </div>
            <div class="coluna-preview">
              <img id="preview-imagem" class="img-preview" alt="">
            </div>
          </div>

          <!-- Grupo: Galeria de Imagens -->
          <div class="grupo-galeria">
            <div class="coluna-galeria">
              <label>Imagens secund√°rias:</label>
              <input type="file" id="file-secundarias" multiple accept="image/*">
              <div id="lista-secundarias" class="galeria-preview"></div>
            </div>
            <div class="coluna-galeria">
              <label>Plantas do im√≥vel:</label>
              <input type="file" id="file-plantas" multiple accept="image/*">
              <div id="lista-plantas" class="galeria-preview"></div>
            </div>
          </div>

          <!-- Campo: Pre√ßo -->
          <div class="campo-preco-admin input-metade">
            <span id="preco-editavel-admin" contenteditable="true" class="preco-digitavel-admin"
              data-placeholder="Ex: 120.000,00"></span>
            <span class="prefixo-rs">R$</span>
            <input type="hidden" name="preco" id="preco-admin-real">
          </div>

          <div class="input-icon">
            <input type="number" name="area" step="0.1" placeholder="√Årea">
            <span class="suffix">m¬≤</span>
          </div>

          <!-- Seletores B√°sicos -->
          <select name="tipo" required>
            <option value="">Tipo*</option>
            <option value="casa">Casa</option>
            <option value="apartamento">Apartamento</option>
            <option value="loft">Loft</option>
            <option value="terreno">Terreno</option>
          </select>

          <select name="pretensao">
            <option value="">Finalidade</option>
            <option value="Venda">Venda</option>
            <option value="Aluguel">Aluguel</option>
          </select>

          <!-- Est√°gio e Entrega -->
          <select name="estagio" id="estagio-imovel-select">
            <option value="">Est√°gio da obra</option>
            <option value="PRONTA">PRONTA</option>
            <option value="EM CONSTRU√á√ÉO">EM CONSTRU√á√ÉO</option>
          </select>
          <input type="text" name="entrega" id="entrega-imovel-input" placeholder="Previs√£o de entrega" disabled>

          <!-- Caracter√≠sticas do Im√≥vel -->
          <input type="number" name="quartos" placeholder="Quartos">
          <input type="number" name="suites" placeholder="Su√≠tes">
          <input type="number" name="banheiros" placeholder="Banheiros">
          <input type="number" name="banheiros_com_chuveiro" placeholder="Banheiros C/ Chuveiro">
          <input type="number" name="vagas" placeholder="Vagas">

          <!-- Localiza√ß√£o -->
          <input type="number" name="andar" placeholder="Andar">
          <input type="text" name="endereco" placeholder="Endere√ßo">
          <input type="text" name="bairro" placeholder="Bairro">
          <input type="text" name="cidade" placeholder="Cidade">
          <input type="text" name="uf" placeholder="UF">

          <!-- Valores Adicionais -->
          <div class="campo-preco-admin input-metade">
            <span id="iptu-editavel-admin" contenteditable="true" class="preco-digitavel-admin"
              data-placeholder="IPTU"></span>
            <span class="prefixo-rs">R$</span>
            <input type="hidden" name="iptu" id="iptu-admin-real">
          </div>

          <div class="campo-preco-admin input-metade">
            <span id="condominio-editavel-admin" contenteditable="true" class="preco-digitavel-admin"
              data-placeholder="Condom√≠nio"></span>
            <span class="prefixo-rs">R$</span>
            <input type="hidden" name="valor_condominio" id="condominio-admin-real">
          </div>

          <!-- Links e Extras -->
          <input type="text" name="link" placeholder="Link externo (ex: Google Maps)" class="input-metade">
          <input type="text" name="maps_iframe" placeholder="Iframe Google Maps">
          <input type="text" name="campo_extra2" placeholder="Campo Extra 1">

          <!-- Empreendimento e Caracter√≠sticas -->
          <select name="empreendimento_id" id="empreendimento-select">
            <option value="">Sem empreendimento</option>
          </select>

          <label class="checkbox-custom">
            <input type="checkbox" name="piscina" id="piscina">
            <span class="checkmark"></span>
            Piscina
          </label>

          <label class="checkbox-custom">
            <input type="checkbox" name="churrasqueira" id="churrasqueira">
            <span class="checkmark"></span>
            Churrasqueira
          </label>

          <label class="switch">
            <input type="checkbox" name="ativo" checked>
            <span class="slider"></span>
            <small>Ativo</small>
          </label>

          <div class="form-actions">
            <button type="submit" class="primary">Cadastrar Im√≥vel</button>
          </div>
        </form>
      </div>

      <!-- ===========================
           M√ìDULO: FORMUL√ÅRIO EMPREENDIMENTOS
           =========================== -->
      <div id="tab-empreendimentos" class="tab-content">
        <form id="form-empreendimento" class="form-grid">
          <input type="text" name="nome" placeholder="Nome do empreendimento" required>
          <textarea name="descricao" placeholder="Descri√ß√£o do empreendimento"></textarea>

          <!-- Grupo: Imagem Principal -->
          <div class="grupo-imagem-principal">
            <div class="coluna-imagem">
              <label>Imagem principal:</label>
              <input type="file" id="file-imagem-emp" accept="image/*">
              <input type="text" name="imagem" id="input-imagem-emp" placeholder="Ou informe uma URL da imagem">
            </div>
            <div class="coluna-preview">
              <img id="preview-imagem-emp" class="img-preview" alt="">
            </div>
          </div>

          <!-- Grupo: Imagens Secund√°rias -->
          <div class="grupo-imagens-secundarias">
            <div class="coluna-galeria">
              <label>Imagens secund√°rias:</label>
              <input type="file" id="file-secundarias-emp" multiple accept="image/*">
              <div id="lista-secundarias-emp" class="galeria-preview"></div>
            </div>
          </div>

          <!-- Localiza√ß√£o -->
          <input type="text" name="endereco_completo" placeholder="Endere√ßo completo">
          <input type="text" name="bairro" placeholder="Bairro">
          <input type="text" name="cidade" placeholder="Cidade">
          <input type="text" name="uf" placeholder="UF" maxlength="2">

          <!-- Est√°gio e Datas -->
          <select name="estagio">
            <option value="">Est√°gio da obra</option>
            <option value="LAN√áAMENTO">LAN√áAMENTO</option>
            <option value="EM CONSTRU√á√ÉO">EM CONSTRU√á√ÉO</option>
            <option value="PRONTO">PRONTO</option>
            <option value="ENTREGUE">ENTREGUE</option>
          </select>

          <!-- <input type="date" name="lancamento" placeholder="Data de lan√ßamento">
          <input type="date" name="entrega" placeholder="Previs√£o de entrega"> -->

          <!-- Caracter√≠sticas do Empreendimento -->
          <input type="number" name="total_unidades" placeholder="Total de unidades">
          <!-- <input type="number" name="n_andares" placeholder="N√∫mero de andares">
          
          <div class="input-icon">
            <input type="number" name="area_laje" step="0.01" placeholder="√Årea da laje">
            <span class="suffix">m¬≤</span>
          </div> -->

          <!-- Mensagem informativa -->
          <div class="mensagem-automatica">
            <p>Campos abaixo ser√£o preenchidos automaticamente com informa√ß√µes dos im√≥veis dispon√≠veis caso fiquem em
              branco.</p>
          </div>

          <!-- Faixas de Pre√ßo -->
          <div class="campo-preco-admin input-metade">
            <span id="preco-min-editavel" contenteditable="true" class="preco-digitavel-admin"
              data-placeholder="Pre√ßo m√≠nimo"></span>
            <span class="prefixo-rs">R$</span>
            <input type="hidden" name="preco_minimo" id="preco-min-real">
          </div>

          <div class="campo-preco-admin input-metade">
            <span id="preco-max-editavel" contenteditable="true" class="preco-digitavel-admin"
              data-placeholder="Pre√ßo m√°ximo"></span>
            <span class="prefixo-rs">R$</span>
            <input type="hidden" name="preco_maximo" id="preco-max-real">
          </div>

          <!-- Faixas de √Årea -->
          <div class="input-icon">
            <input type="number" name="area_minima" step="0.01" placeholder="√Årea m√≠nima">
            <span class="suffix">m¬≤</span>
          </div>

          <div class="input-icon">
            <input type="number" name="area_maxima" step="0.01" placeholder="√Årea m√°xima">
            <span class="suffix">m¬≤</span>
          </div>

          <!-- Faixas de Quartos e Vagas -->
          <input type="number" name="quartos_minimo" placeholder="Quartos m√≠nimo">
          <input type="number" name="quartos_maximo" placeholder="Quartos m√°ximo">
          <input type="number" name="vagas_minimo" placeholder="Vagas m√≠nimo">
          <input type="number" name="vagas_maximo" placeholder="Vagas m√°ximo">

          <!-- Informa√ß√µes Adicionais -->
          <input type="text" name="ri" placeholder="RI (Registro de Incorpora√ß√£o)">
          <input type="text" name="iptu" placeholder="IPTU">

          <!-- Sele√ß√£o de Im√≥veis -->
          <div class="grupo-imoveis-empreendimento">
            <label>Im√≥veis do empreendimento:</label>
            <div class="imoveis-selection-container">
              <div class="imoveis-list">
                <h4>Dispon√≠veis</h4>
                <select id="imoveis-disponiveis" multiple size="8">
                  <!-- Preenchido via JavaScript -->
                </select>
              </div>
              <div class="imoveis-controls">
                <button type="button" id="btn-adicionar-imovel">‚Üí</button>
                <button type="button" id="btn-remover-imovel">‚Üê</button>
              </div>
              <div class="imoveis-list">
                <h4>Selecionados</h4>
                <select id="imoveis-selecionados" name="imoveis_ids[]" multiple size="8">
                  <!-- Im√≥veis selecionados -->
                </select>
              </div>
            </div>
            <small>Selecione os im√≥veis que fazem parte deste empreendimento</small>
          </div>


          <label class="switch">
            <input type="checkbox" name="ativo" checked>
            <span class="slider"></span>
            <small>Ativo</small>
          </label>

          <div class="form-actions">
            <button type="submit" class="primary">Cadastrar Empreendimento</button>
          </div>
        </form>
      </div>

    </section>

    <!-- ===========================
         M√ìDULO: VIEW INFO
         =========================== -->
    <section id="view-info" class="view">
      <header class="view-header">
        <h1>Info</h1>
      </header>

      <div class="info-cards">
        <div class="info-card">
          <h3>Total de im√≥veis</h3>
          <div id="kpi-total">‚Äî</div>
        </div>
        <div class="info-card">
          <h3>Im√≥veis ativos</h3>
          <div id="kpi-ativos">‚Äî</div>
        </div>

      </div>

      <!-- Bloco: Sistema e Backup -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Sistema e Backups</h2>
          <small class="bloco-subtitle">Gerencie os dados e realize c√≥pias de seguran√ßa</small>
        </div>
        <div class="acoes-sistema">
          <p style="margin-bottom: 1rem; color: #666;">Use as op√ß√µes abaixo para gerenciar a seguran√ßa e visualiza√ß√£o dos dados.</p>
          <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
            <button id="btn-backup" class="primary">
              <img src="/static/img/icons/icon_link.svg" alt="" style="width: 16px; filter: invert(1); margin-right: 8px;">
              Backup de Seguran√ßa (.sql)
            </button>
            <button id="btn-exportar-completo" class="primary" style="background-color: #28a745;">
              <img src="/static/img/icons/icon_link.svg" alt="" style="width: 16px; filter: invert(1); margin-right: 8px;">
              Exportar Dados Completos (.zip)
            </button>
          </div>
          <small style="display: block; margin-top: 10px; color: #888;">
            * O arquivo <b>.sql</b> √© para restaura√ß√£o completa em caso de perda total.<br>
            * O arquivo <b>.zip</b> cont√©m planilhas (CSVs) de im√≥veis, empreendimentos, leads e acessos.
          </small>
        </div>
      </div>

      <!-- Bloco: Destaques -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Em destaque <small id="cont-destaques">0/6</small></h2>
        </div>
        <div id="destaques-grid" class="cards cards-destaque">
          <!-- Cards de destaque (preenchidos via JS) -->
          <div class="card add-card" id="btn-add-destaque" title="Adicionar destaque">
            <span>+</span>
          </div>
        </div>
      </div>

      <!-- Bloco: Visualiza√ß√µes -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Visualiza√ß√µes dos Im√≥veis</h2>
          <button id="btn-atualizar-visualizacoes" class="btn-secundario">Atualizar</button>
        </div>
        <div class="visualizacoes-container">
          <div class="visualizacoes-stats">
            <div class="stat-card">
              <h4>Total de Visualiza√ß√µes</h4>
              <div id="total-visualizacoes">‚Äî</div>
            </div>
            <div class="stat-card">
              <h4>Esta Semana</h4>
              <div id="visualizacoes-semana">‚Äî</div>
            </div>
            <div class="stat-card">
              <h4>Este M√™s</h4>
              <div id="visualizacoes-mes">‚Äî</div>
            </div>
          </div>
          <div class="visualizacoes-tabela">
            <table id="tabela-visualizacoes">
              <thead>
                <tr>
                  <th>Im√≥vel</th>
                  <th>Total</th>
                  <th>7 dias</th>
                  <th>30 dias</th>
                </tr>
              </thead>
              <tbody id="lista-visualizacoes">
                <tr>
                  <td colspan="4" class="loading">Carregando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </section>

    <!-- ===========================
         M√ìDULO: VIEW CORRETORES
         =========================== -->
    <section id="view-corretores" class="view">
      <header class="view-header">
        <h1>Gest√£o de Corretores</h1>
      </header>

      <!-- Gest√£o de Corretores -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Equipe de Vendas</h2>
          <small class="bloco-subtitle">Adicione e gerencie o acesso dos corretores</small>
        </div>

        <div class="card-admin">
          <h3>Adicionar Novo Corretor</h3>
          <form id="form-novo-corretor" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
            <input type="text" id="novo-corretor-nome" placeholder="Nome do Corretor" required style="flex: 1; min-width: 200px;">
            <input type="text" id="novo-corretor-senha" placeholder="Senha de Acesso" required style="flex: 1; min-width: 200px;">
            <button type="submit" class="primary">Adicionar</button>
          </form>

          <h3>Corretores Cadastrados</h3>
          <table class="tabela-admin" style="width: 100%; border-collapse: collapse; margin-top: 15px;">
            <thead>
              <tr style="background: #f4f4f4; text-align: left;">
                <th style="padding: 10px;">Nome</th>
                <th style="padding: 10px;">Status</th>
                <th style="padding: 10px;">A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="lista-corretores">
              <!-- Preenchido via JS -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- Gerador de Links -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Gerador de Link Personalizado</h2>
          <small class="bloco-subtitle">Crie links de cadastro espec√≠ficos para cada im√≥vel</small>
        </div>

        <div class="card-admin">
          <div style="background: #e8f4fd; padding: 15px; border-radius: 6px; border-left: 4px solid #2196F3; margin-bottom: 20px;">
            <h4 style="margin: 0 0 10px 0; color: #0d47a1;">üí° Como usar</h4>
            <ol style="margin: 0; padding-left: 20px; color: #333; line-height: 1.6;">
              <li>Selecione um im√≥vel na lista abaixo.</li>
              <li>Clique em <b>"Gerar Link"</b>.</li>
              <li>Copie o link gerado e use em seus an√∫ncios.</li>
              <li>O cliente cair√° no sistema j√° vinculado a este im√≥vel!</li>
            </ol>
          </div>

          <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
            <select id="select-imovel-link" style="flex: 1; padding: 10px; min-width: 200px;">
              <option value="">Carregando im√≥veis...</option>
            </select>
            <button id="btn-gerar-link" class="primary">Gerar Link</button>
          </div>
          
          <div id="container-link-gerado" style="margin-top: 15px; display: none;">
            <div style="display: flex; gap: 10px;">
                <input type="text" id="link-gerado" readonly style="flex: 1; padding: 10px; background: #eee; border: 1px solid #ddd;">
                <button id="btn-copiar-link" class="btn-secundario">Copiar</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===========================
         M√ìDULO: VIEW SLIDES
         =========================== -->
    <section id="view-slides" class="view">
      <header class="view-header">
        <h1>Slides de Exposi√ß√£o</h1>
        <div class="actions">
          <a href="/slides" target="_blank" class="primary link-button">Abrir apresenta√ß√£o</a>
        </div>
      </header>

      <div class="bloco">
        <div class="bloco-head">
          <h2>Configura√ß√£o dos slides</h2>
          <small class="bloco-subtitle">Escolha os im√≥veis e o tempo de exibi√ß√£o</small>
        </div>

        <div class="slides-config">
          <div class="grupo-imoveis-empreendimento">
            <label>Im√≥veis na apresenta√ß√£o:</label>
            <div class="imoveis-selection-container">
              <div class="imoveis-list">
                <h4>Dispon√≠veis</h4>
                <select id="slides-imoveis-disponiveis" multiple size="10">
                </select>
              </div>
              <div class="imoveis-controls">
                <button type="button" id="btn-slides-adicionar">‚Üí</button>
                <button type="button" id="btn-slides-remover">‚Üê</button>
              </div>
              <div class="imoveis-list">
                <h4>Selecionados</h4>
                <select id="slides-imoveis-selecionados" multiple size="10">
                </select>
              </div>
            </div>
          </div>

          <div class="slides-config-row">
            <div class="slides-intervalo">
              <label for="slides-intervalo-input">Tempo por slide (segundos)</label>
              <input type="number" id="slides-intervalo-input" min="3" max="60" step="1" value="8">
            </div>
            <button type="button" id="btn-slides-salvar" class="primary">Salvar configura√ß√£o</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===========================
         M√ìDULO: VIEW INTERESSE
         =========================== -->
    <section id="view-interesse" class="view">
      <header class="view-header">
        <h1>Cadastros de Interesse</h1>
        <div class="actions">
          <button id="btn-atualizar">Atualizar</button>
        </div>
      </header>

      <div class="info-cards">
        <div class="info-card">
          <h3>Total de cadastros</h3>
          <div id="kpi-total-interesse">‚Äî</div>
        </div>
        <div class="info-card">
          <h3>Cadastros hoje</h3>
          <div id="kpi-hoje-interesse">‚Äî</div>
        </div>
      </div>

      <!-- Tabela de Interesse -->
      <div class="bloco">
        <div class="bloco-head">
          <h2>Clientes Interessados</h2>
          <small class="bloco-subtitle">Clique no WhatsApp para conversar diretamente</small>
        </div>
        <div class="interesse-table-container">
          <table id="tabela-interesse" class="interesse-table">
            <thead>
               <tr>
                 <th>Nome</th>
                 <th>Email</th>
                 <th>WhatsApp</th>
                 <th>Data/Hora</th>
                 <th>A√ß√µes</th>
               </tr>
             </thead>
            <tbody id="lista-interesse">
              <!-- Dados carregados via JavaScript -->
            </tbody>
          </table>
        </div>
      </div>

    </section>

  </main>

  <!-- ===========================
       M√ìDULO: MODAL DESTAQUES
       =========================== -->
  <div id="modal-destaque" class="modal modal-hidden">
    <div class="modal-content">
      <h2>Selecionar im√≥veis em destaque (m√°x. 6)</h2>
      <div id="lista-destaque-modal"></div>
      <button id="btn-salvar-destaques">Salvar Destaques</button>
      <button type="button" onclick="document.getElementById('modal-destaque').style.display='none'">Cancelar</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="/static/js/dashboard.js"></script>
</body>

</html>
